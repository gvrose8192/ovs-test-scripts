if [ "$#" -ne 2 ]; then
    echo "Please provide the final octet of the IP address for the overlay bridge and the port to add"
    exit 1
fi
rm /usr/local/var/log/openvswitch/ovs-vswitchd.log
ethtool -K $2 hw-tc-offload on
ethtool -k $2 | grep hw-tc-offload
ovs-ctl start
ovs-vsctl set Open_vSwitch . other_config:hw-offload=true
ovs-vsctl set Open_vSwitch . other_config:tc-policy=skip_sw
ovs-ctl restart
if tc qdisc show dev $2 | grep ingress; then
    echo $2 qdisc ingress already set
else
   tc qdisc add dev $2 ingress
fi
tc qdisc del dev $2 ingress
ovs-vsctl --may-exist add-br br0
ovs-vsctl --may-exist add-port br0 $2
# ovs-ofctl add-flow br0 "actions=normal"
ip addr add 171.31.1.$1/24 dev br0
ip link set br0 up
ovs-appctl vlog/set netdev_offload:dbg
ovs-appctl vlog/set netdev_offload_tc:dbg
ovs-appctl vlog/set dpif_netlink:dbg
ovs-appctl vlog/set tc:dbg
ip link set $2 up
# ip link set dev br0 mtu 1450
